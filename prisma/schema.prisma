generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Summary {
  id                  String        @id @default(uuid())
  youtubeUrl          String
  status              SummaryStatus @default(QUEUED)
  percent             Int           @default(0)
  startedAt           DateTime      @default(now())
  finishedAt          DateTime?
  transcriptPath      String?
  bulletPath          String?
  summaryPath         String?
  sceneFactsPath      String?
  whisperModel        String?
  asrDevice           String?
  vlDevice            String?
  vlModel             String?
  sceneThresh         Float?
  enableOcr           Boolean?
  frames              Int?
  bulletCount         Int?
  transcriptWord      Int?
  summaryWord         Int?
  timeDownloadSec     Float?
  timeSpeechtoTextSec Float?
  timeCaptionImageSec Float?
  timeSummarizeSec    Float?
  timeTotal           Float?
  durationSec         Float?
  errorMessage        String?
  keyword             String?
  userId              Int
  user User @relation(fields: [userId], references: [id])

  @@index([status, startedAt])
}

model User {
  id        Int       @id @default(autoincrement())
  username  String    @unique
  password  String
  createdAt DateTime  @default(now())
  summaries Summary[]
}

enum SummaryStatus {
  QUEUED
  RUNNING
  DONE
  ERROR
  CANCEL
}
